<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayurvedic Dosha Predictor (Client)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f8f8f8; }
        h1 { text-align: center; color: #5a2e6f; }
        .intro { text-align: center; margin-bottom: 30px; color: #666; }
        .feature-group { margin-bottom: 15px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: #fff; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #5a2e6f; }
        input[type="text"], select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #5a2e6f; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 18px; width: 100%; margin-top: 20px; transition: background-color 0.3s; }
        button:hover { background-color: #432152; }
        #result-container { margin-top: 30px; padding: 25px; border: 2px solid #5a2e6f; border-radius: 8px; text-align: center; background-color: #f0e6f7; }
        #prediction-result { font-size: 30px; font-weight: bold; color: #333; margin-top: 10px; }
        .error { color: #d9534f; font-weight: bold; }
        .selector-group { margin-bottom: 25px; padding: 15px; background-color: #e6f7ff; border-radius: 5px; }
    </style>
</head>
<body>

    <h1>ðŸ”® Ayurvedic Prakriti Predictor</h1>
    <p class="intro">Use the selector below to load a profile for testing your CatBoost model.</p>

    <div class="selector-group">
        <label for="profile-selector">Select Test Profile:</label>
        <select id="profile-selector">
            <option value="VataPitta" selected>Vata-Pitta (Original Test Case)</option>
            <option value="VataKapha">Vata-Kapha</option>
            <option value="PittaKapha">Pitta-Kapha</option>
            <option value="Tridoshic">Tridoshic (Vata-Pitta-Kapha)</option>
        </select>
    </div>

    <form id="dosha-form">
        </form>

    <button id="predict-button" type="submit" form="dosha-form">âœ¨ Predict Dosha</button>

    <div id="result-container">
        <h2>Predicted Dosha:</h2>
        <p id="prediction-result">Load a profile and click 'Predict'.</p>
    </div>

    <script>
        const API_URL = 'http://127.0.0.1:8000/predict_dosha'; 
        
        const FEATURE_COLUMNS = [
            "Body Size", "Body Weight", "Height", "Bone Structure", "Complexion",
            "General feel of skin", "Texture of Skin", "Hair Color", "Appearance of Hair",
            "Shape of face", "Eyes", "Eyelashes", "Blinking of Eyes", "Cheeks", "Nose",
            "Teeth and gums", "Lips", "Nails", "Appetite", "Liking tastes",
            "Metabolism Type", "Climate Preference", "Stress Levels", "Sleep Patterns",
            "Dietary Habits", "Physical Activity Level", "Water Intake", "Digestion Quality",
            "Skin Sensitivity"
        ];

        // --- DEFINITIONS FOR ALL FOUR PROFILES ---
        const PROFILES = {
            // Your original Vata-Pitta Profile
            "VataPitta": {
                "Body Size": "Medium", "Body Weight": "Moderate - no difficulties in gaining or losing weight", "Height": "Average",
                "Bone Structure": "Large, broad shoulders , heavy bone structure", "Complexion": "White, pale, tans easily",
                "General feel of skin": "Dry and thin, cool to touch, rough", "Texture of Skin": "Dry, pigments and aging",
                "Hair Color": "Black/Brown,dull", "Appearance of Hair": "Straight, oily", "Shape of face": "Long, angular, thin",
                "Eyes": "Medium-sized, penetrating, light-sensitive eyes", "Eyelashes": "Moderate eyelashes",
                "Blinking of Eyes": "Moderate Blinking", "Cheeks": "Wrinkled, Sunken", "Nose": "Rounded, Large open nostrils",
                "Teeth and gums": "Big, White, Strong teeth, Healthy gums", "Lips": "Tight, thin, dry lips which chaps easily",
                "Nails": "Thick, Oily, Smooth, Polished", "Appetite": "Slow but steady", "Liking tastes": "Sweet / Sour / Salty",
                "Metabolism Type": "fast", "Climate Preference": "warm", "Stress Levels": "moderate", "Sleep Patterns": "moderate",
                "Dietary Habits": "vegan", "Physical Activity Level": "moderate", "Water Intake": "moderate", "Digestion Quality": "moderate",
                "Skin Sensitivity": "sensitive"
            },
            
            // The Vata-Kapha Profile
            "VataKapha": {
                "Body Size": "Large", "Body Weight": "Heavy - easy to gain weight", "Height": "Average", 
                "Bone Structure": "Heavy, thick, well-covered", "Complexion": "Pale, oily, smooth",
                "General feel of skin": "Dry and thin, cool to touch, rough", "Texture of Skin": "Dry, prone to flaking", 
                "Hair Color": "Black/Brown, dull", "Appearance of Hair": "Thick, abundant, oily", 
                "Shape of face": "Round, full", "Eyes": "Large, wet, attractive", "Eyelashes": "Sparse", 
                "Blinking of Eyes": "Slow, steady Blinking", "Cheeks": "Sunken", "Nose": "Rounded, Large, fleshy",
                "Teeth and gums": "Irregular, receding gums", "Lips": "Full, soft, oily lips", 
                "Nails": "Dry, Rough, Brittle, Break", "Appetite": "Irregular and variable", 
                "Liking tastes": "Pungent / Bitter / Astringent", "Metabolism Type": "slow", 
                "Climate Preference": "warm", "Stress Levels": "low", "Sleep Patterns": "disturbed", 
                "Dietary Habits": "vegetarian", "Physical Activity Level": "sedentary", 
                "Water Intake": "low", "Digestion Quality": "poor", "Skin Sensitivity": "normal"
            },
            
            // The Pitta-Kapha Profile
            "PittaKapha": {
                "Body Size": "Medium", "Body Weight": "Moderate - easy to gain, hard to lose", "Height": "Average", 
                "Bone Structure": "Medium bone structure", "Complexion": "White, pale, tans easily", 
                "General feel of skin": "Soft, moist, cool to touch", "Texture of Skin": "Oily, prone to rashes", 
                "Hair Color": "Red, light brown, yellow", "Appearance of Hair": "Fine, soft, oily", 
                "Shape of face": "Round, full", "Eyes": "Medium-sized, penetrating, light-sensitive eyes", 
                "Eyelashes": "Moderate eyelashes", "Blinking of Eyes": "Slow, steady Blinking", 
                "Cheeks": "Smooth, Flat", "Nose": "Pointed, reddish tip",
                "Teeth and gums": "Medium-sized teeth, Reddish gums", "Lips": "Full, soft, oily lips", 
                "Nails": "Soft, smooth, polished", "Appetite": "Strong, intense, can skip meals", 
                "Liking tastes": "Sweet / Bitter / Astringent", "Metabolism Type": "moderate", 
                "Climate Preference": "cool", "Stress Levels": "high", "Sleep Patterns": "heavy, sound, prolonged", 
                "Dietary Habits": "non-vegetarian", "Physical Activity Level": "moderate", 
                "Water Intake": "high", "Digestion Quality": "strong, slightly acidic", "Skin Sensitivity": "sensitive"
            },
            
            // The Tridoshic Profile
            "Tridoshic": {
                "Body Size": "Medium", "Body Weight": "Moderate - fluctuates easily", "Height": "Average", 
                "Bone Structure": "Medium bone structure", "Complexion": "Balanced, sometimes pale, sometimes flushed", 
                "General feel of skin": "Variableâ€”sometimes dry and cool, sometimes warm and moist", 
                "Texture of Skin": "Combinationâ€”oily in T-zone, dry elsewhere", "Hair Color": "Brown", 
                "Appearance of Hair": "Wavy, moderate amount, average texture", 
                "Shape of face": "Balanced, neither too long nor too round", "Eyes": "Average size, light-sensitive at times", 
                "Eyelashes": "Moderate eyelashes", "Blinking of Eyes": "Moderate Blinking", "Cheeks": "Average fullness", 
                "Nose": "Average shape, well-proportioned",
                "Teeth and gums": "Average size and health", "Lips": "Medium fullness, occasionally dry", 
                "Nails": "Average strength, occasionally brittle", "Appetite": "Variableâ€”strongest in mid-day, sometimes irregular", 
                "Liking tastes": "All tastes equally tolerated", "Metabolism Type": "moderate, balanced", 
                "Climate Preference": "prefers moderate climates, dislikes extremes", 
                "Stress Levels": "moderate", "Sleep Patterns": "regular 7-8 hours, occasionally light/disturbed", 
                "Dietary Habits": "balanced, omnivore", "Physical Activity Level": "moderate", 
                "Water Intake": "moderate", "Digestion Quality": "moderate, mostly good", "Skin Sensitivity": "normal"
            }
        };


        function renderForm(profileData = PROFILES["VataPitta"]) {
            const form = document.getElementById('dosha-form');
            form.innerHTML = ''; // Clear existing fields
            
            FEATURE_COLUMNS.forEach(col => {
                const colSnakeCase = col.toLowerCase().replace(/ /g, '_');
                
                const group = document.createElement('div');
                group.className = 'feature-group';
                
                const label = document.createElement('label');
                label.htmlFor = colSnakeCase;
                label.textContent = col + ':';
                
                const input = document.createElement('input');
                input.type = 'text';
                input.id = colSnakeCase;
                input.name = colSnakeCase;
                input.placeholder = `Enter value for ${col}`;
                // Set the value from the selected profile
                input.value = profileData[col] || ''; 
                
                group.appendChild(label);
                group.appendChild(input);
                form.appendChild(group);
            });
        }

        function loadSelectedProfile() {
            const selector = document.getElementById('profile-selector');
            const selectedProfileKey = selector.value;
            const profileData = PROFILES[selectedProfileKey];
            renderForm(profileData);
            document.getElementById('prediction-result').textContent = `Loaded ${selectedProfileKey} profile.`;
            document.getElementById('prediction-result').style.color = '#333';
        }

        async function handleSubmit(event) {
            event.preventDefault(); 
            
            const resultDisplay = document.getElementById('prediction-result');
            resultDisplay.innerHTML = '<span style="color:#a4c2f4;">Predicting...</span>';
            resultDisplay.className = '';

            const formData = new FormData(event.target);
            const data = {};
            for (const [key, value] of formData.entries()) {
                data[key] = value;
            }

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();

                if (response.ok && result.status === 'success') {
                    resultDisplay.textContent = result.predicted_dosha.toUpperCase();
                    resultDisplay.style.color = '#5a2e6f';
                } else {
                    const errorMessage = result.message || 'API Error: Could not get prediction.';
                    resultDisplay.textContent = `Error: ${errorMessage}`;
                    resultDisplay.className = 'error';
                }
            } catch (error) {
                resultDisplay.textContent = `Network Error: Could not connect to the API. Is your uvicorn server running?`;
                resultDisplay.className = 'error';
            }
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Render the form with the default profile (VataPitta)
            renderForm(); 

            // 2. Attach event listener for form submission
            document.getElementById('dosha-form').addEventListener('submit', handleSubmit);

            // 3. Attach event listener for the profile selector change
            document.getElementById('profile-selector').addEventListener('change', loadSelectedProfile);
        });
    </script>

</body>
</html>